<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Casino Roulette - Game Zone Myanmar</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a1a, #2c003e);
            color: #ffd700;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .game-container {
            width: 100%;
            max-width: 400px;
            height: 100%;
            background: rgba(30, 30, 30, 0.9);
            padding: 10px;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.5);
            text-align: center;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border-radius: 15px;
            overflow: hidden;
        }
        h1 {
            font-size: 1.8em;
            margin: 10px 0;
            color: #ffd700;
            text-shadow: 0 0 15px #ffd700, 0 0 5px #ff4500;
            letter-spacing: 1px;
        }
        .roulette {
            width: 100%;
            max-width: 300px;
            height: 300px;
            background: #222;
            border-radius: 50%;
            margin: 10px auto;
            position: relative;
            border: 5px solid #ffd700;
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.7), 0 0 20px rgba(255, 215, 0, 0.5);
            overflow: hidden;
            display: none;
        }
        .number-slot {
            position: absolute;
            width: 25px;
            height: 25px;
            text-align: center;
            font-size: 12px;
            color: #fff;
            transform-origin: 50% 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 0 0 5px #000;
        }
        .pointer {
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #fff, #ffd700);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 3px solid #000;
            z-index: 2;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }
        .pointer.spinning {
            animation: spinBall 8s ease-out forwards;
        }
        @keyframes spinBall {
            0% { transform: translate(-50%, -50%) rotate(0deg) translateX(135px) rotate(0deg); }
            60% { transform: translate(-50%, -50%) rotate(1080deg) translateX(135px) rotate(-1080deg); }
            85% { transform: translate(-50%, -50%) rotate(var(--final-angle)) translateX(80px) rotate(-var(--final-angle)); }
            100% { transform: translate(-50%, -50%) rotate(var(--final-angle)) translateX(0) rotate(-var(--final-angle)); }
        }
        .bet-table {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            width: 95%;
            margin: 10px auto;
            font-size: 0.9em;
        }
        .bet-area {
            padding: 8px;
            background: #333;
            border: 2px solid #ffd700;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            min-height: 35px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
        }
        .bet-area:hover {
            background: #555;
            transform: scale(1.05);
        }
        .bet-area.red { background: #f44336; }
        .bet-area.black { background: #000; }
        .bet-area.green { background: #4caf50; }
        .bonus-x {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ff4500;
            color: #fff;
            padding: 5px;
            border-radius: 50%;
            font-size: 10px;
            animation: bonusPop 1s ease-in-out;
            box-shadow: 0 0 10px rgba(255, 69, 0, 0.8);
        }
        @keyframes bonusPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        .bet-chip {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #b8860b);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: #000;
            box-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
        }
        .user-bet {
            position: absolute;
            top: 5px;
            left: 5px;
            font-size: 8px;
            color: #00ff00;
            background: rgba(0, 0, 0, 0.8);
            padding: 3px;
            border-radius: 3px;
            text-shadow: 0 0 3px #000;
        }
        .all-bet {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 8px;
            color: #fff;
            background: rgba(0, 0, 0, 0.8);
            padding: 3px;
            border-radius: 3px;
            text-shadow: 0 0 3px #000;
        }
        .bet-chips {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .chip {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #b8860b);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            transition: transform 0.3s ease;
            font-size: 12px;
            color: #000;
            text-shadow: 0 0 3px #fff;
        }
        .chip:hover {
            transform: scale(1.1);
        }
        .chip.active {
            border: 3px solid #fff;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
        }
        .chip-animation {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #b8860b);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
            animation: flyToBet 1s ease-out forwards;
            font-size: 12px;
            color: #000;
            text-shadow: 0 0 3px #fff;
        }
        @keyframes flyToBet {
            0% { transform: translate(0, 0); opacity: 1; }
            100% { transform: translate(var(--target-x), var(--target-y)); opacity: 0; }
        }
        #result {
            font-size: 1.2em;
            margin: 10px 0;
            text-shadow: 0 0 10px #ffd700;
            flex-grow: 1;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
        }
        #balance, #online-players {
            font-size: 1.2em;
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
        }
        #balance {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 5px;
        }
        #online-players {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 5px;
        }
        .money-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        input, select {
            padding: 8px;
            border: none;
            border-radius: 5px;
            background: #fff;
            color: #000;
            width: 100px;
            font-size: 12px;
            box-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        button {
            padding: 8px 15px;
            background: linear-gradient(45deg, #ffd700, #b8860b);
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            transition: transform 0.3s ease;
            font-size: 12px;
            text-shadow: 0 0 3px #fff;
        }
        button:hover {
            transform: scale(1.1);
        }
        button:disabled {
            background: #555;
            cursor: not-allowed;
            box-shadow: none;
        }
        .menu-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 8px;
            background: linear-gradient(45deg, #ffd700, #b8860b);
            border: none;
            border-radius: 5px;
            color: #000;
            cursor: pointer;
            z-index: 2;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            font-size: 12px;
        }
        .logout-btn {
            position: absolute;
            top: 10px;
            right: 70px;
            padding: 8px;
            background: linear-gradient(45deg, #ff4500, #b8860b);
            border: none;
            border-radius: 5px;
            color: #fff;
            cursor: pointer;
            z-index: 2;
            box-shadow: 0 0 10px rgba(255, 69, 0, 0.5);
            font-size: 12px;
        }
        .guide {
            position: absolute;
            top: 50px;
            left: 10px;
            background: rgba(30, 30, 30, 0.95);
            padding: 15px;
            border-radius: 10px;
            color: #ffd700;
            font-size: 0.9em;
            z-index: 2;
            display: none;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            max-width: 250px;
            text-align: left;
            line-height: 1.5;
        }
        .guide.active {
            display: block;
        }
        .timer {
            font-size: 1.5em;
            color: #ff4500;
            text-shadow: 0 0 10px #ff4500;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 5px;
        }
        .history {
            width: 95%;
            margin: 0 auto;
            padding: 10px 0;
            font-size: 0.9em;
            color: #ffd700;
            text-align: center;
            position: relative;
            z-index: 1;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
        }
        .history-item {
            display: inline-block;
            margin: 0 8px;
            font-size: 14px;
            padding: 5px 10px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        .history-item.black {
            background: #000;
        }
        .history-item.red {
            background: #f44336;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        .modal-content {
            background: #1e1e1e;
            padding: 25px;
            border-radius: 15px;
            color: #ffd700;
            text-align: center;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        .modal input, .modal select {
            margin: 10px 0;
            width: 100%;
            padding: 10px;
            font-size: 14px;
        }
        .modal button {
            margin: 10px 5px;
            padding: 10px 20px;
        }
        #loginModal {
            display: flex;
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer" style="display: none;">
        <button class="menu-btn" onclick="toggleGuide()">üìú Menu</button>
        <button class="logout-btn" onclick="logout()">üö™ Logout</button>
        <div class="guide" id="guide">
            üé∞ <b>Casino Roulette ·ÄÄ·ÄÖ·Ä¨·Ä∏·Äî·Ää·Ä∫·Ä∏</b> üé∞<br>
            1. üí∏ ·ÄÑ·ÄΩ·Ä±·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äõ·Äî·Ä∫ "Deposit" ·Äî·Äæ·Ä≠·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏ Kpay/Wave ·Äñ·ÄØ·Äî·Ä∫·Ä∏ (09786284670 - DHMK) ·Äû·Ä≠·ÄØ·Ä∑ ·Äú·ÄΩ·Äæ·Ä≤·Äï·Ä´·Åã ·ÄÑ·ÄΩ·Ä±·Äï·Äô·Ä¨·Äè·Äî·Äæ·ÄÑ·Ä∑·Ä∫ Transaction ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´·Åã<br>
            2. üè¶ ·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äõ·Äî·Ä∫ "Withdraw" ·Äî·Äæ·Ä≠·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏ Kpay/Wave ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Äê·Ä∫·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·Äï·Äô·Ä¨·Äè·Äë·Ää·Ä∑·Ä∫·Äï·Ä´·Åã<br>
            3. üé≤ Chip (1K-1M) ·Äõ·ÄΩ·Ä±·Ä∏·Äï·Äº·ÄÆ·Ä∏ ·Ä°·ÄÄ·ÄΩ·ÄÄ·Ä∫·Äï·Ä±·Ä´·Ä∫ ·Äî·Äæ·Ä≠·Äï·Ä∫·ÄÄ·Ä¨ Bet ·Äê·ÄÑ·Ä∫·Äï·Ä´·Åã<br>
            4. üîÑ 30 ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ ·Ä°·Äú·Ä≠·ÄØ·Ä°·Äú·Äª·Ä±·Ä¨·ÄÄ·Ä∫ Spin ·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏ Bonus X ·Äï·Äº·Äï·Ä´·Äê·Äö·Ä∫·Åã<br>
            5. üéØ Bonus X (x50-x500) ·ÄÄ·Ä≠·ÄØ ·ÄÄ·Äª·Äï·Äî·Ä∫·Ä∏·Ä°·ÄÄ·ÄΩ·ÄÄ·Ä∫ 1-3 ·ÄÅ·ÄØ·Äô·Äæ·Ä¨ ·Äë·Ää·Ä∑·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´·Äê·Äö·Ä∫·Åã<br>
            6. üèÜ ·Ä°·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äõ·Äõ·ÄÑ·Ä∫ 36x + Bonus X ·Äï·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äï·Äº·ÄÆ·Ä∏ Balance ·Äë·Ä≤ ·Äë·Ää·Ä∑·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´·Äê·Äö·Ä∫·Åã<br>
            üé≤ <b>·Äú·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÄ·ÄÖ·Ä¨·Ä∏ ·Ä°·ÄÄ·ÄΩ·ÄÄ·Ä∫·Äô·Äª·Ä¨·Ä∏ ·Äî·Ä≤·Ä∑ ·Ä°·Äú·Äª·Ä±·Ä¨·Ä∫·ÄÖ·Ä¨·Ä∏:</b><br>
            - ·ÄÇ·Äè·Äî·Ä∫·Ä∏ ·ÅÅ ·Äú·ÄØ·Ä∂·Ä∏ (Straight): x36 (+ Bonus X)<br>
            - Black/Red: x2<br>
            - Odd/Even: x2<br>
            - 1-18/19-36: x2<br>
            - Dozens (1-12, 13-24, 25-36): x3<br>
            - Columns (1st, 2nd, 3rd): x3<br>
            üçÄ ·ÄÄ·Ä∂·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·Äï·Ä´·ÄÖ·Ä±! üéâ<br>
            <button onclick="toggleGuide()">‚ùå ·Äï·Ä≠·Äê·Ä∫·Äô·Ää·Ä∫</button>
        </div>
        <div id="online-players">Online Players: 0</div>
        <h1>üé∞ Casino Roulette üé∞</h1>
        <div id="balance">Balance: <span id="balance-value">0</span> MMK</div>
        <div class="money-controls">
            <button onclick="showDepositModal()">üí∏ Deposit</button>
            <button onclick="showWithdrawModal()">üè¶ Withdraw</button>
        </div>
        <div class="timer" id="timer">Time Left: 30s</div>
        <div class="roulette" id="roulette"></div>
        <div class="bet-table" id="betTable"></div>
        <div class="history" id="history"></div>
        <div class="bet-chips" id="betChips">
            <div class="chip" data-value="1000">1K</div>
            <div class="chip" data-value="5000">5K</div>
            <div class="chip" data-value="10000">10K</div>
            <div class="chip" data-value="20000">20K</div>
            <div class="chip" data-value="50000">50K</div>
            <div class="chip" data-value="100000">100K</div>
            <div class="chip" data-value="200000">200K</div>
            <div class="chip" data-value="500000">500K</div>
            <div class="chip" data-value="1000000">1M</div>
        </div>
        <button id="spinBtn" disabled>üé≤ Spin ·Äú·ÄØ·Äï·Ä∫·Äï·Ä´</button>
        <div id="result">·ÄÄ·ÄÖ·Ä¨·Ä∏·Äõ·Äî·Ä∫ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äù·ÄÑ·Ä∫·Äï·Ä´!</div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>üéÆ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Äî·Ä∫</h2>
            <input type="text" id="phone" placeholder="·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Äê·Ä∫ (09xxxxxxxxx)">
            <input type="password" id="pin" placeholder="PIN (6 ·Äú·ÄØ·Ä∂·Ä∏)">
            <button onclick="login()">·Äù·ÄÑ·Ä∫·Äô·Ää·Ä∫</button>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <h2>üí∏ Deposit</h2>
            <p>Kpay/Wave ·Äñ·ÄØ·Äî·Ä∫·Ä∏: <b>09786284670</b> (DHMK)</p>
            <input type="number" id="deposit-amount" placeholder="·ÄÑ·ÄΩ·Ä±·Äï·Äô·Ä¨·Äè (MMK)" min="100" step="100">
            <input type="text" id="transaction-id" placeholder="·Äî·Ä±·Ä¨·ÄÄ·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏ 6 ·Äú·ÄØ·Ä∂·Ä∏ (Transaction ID)">
            <button onclick="submitDeposit()">·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·Ä≠·ÄØ·Äô·Ää·Ä∫</button>
            <button onclick="closeModal('depositModal')">‚ùå ·Äï·Ä≠·Äê·Ä∫·Äô·Ää·Ä∫</button>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div class="modal" id="withdrawModal">
        <div class="modal-content">
            <h2>üè¶ Withdraw</h2>
            <select id="withdraw-method">
                <option value="Kpay">Kpay</option>
                <option value="Wave">Wave</option>
            </select>
            <input type="text" id="withdraw-phone" placeholder="Kpay/Wave ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Äê·Ä∫">
            <input type="number" id="withdraw-amount" placeholder="·ÄÑ·ÄΩ·Ä±·Äï·Äô·Ä¨·Äè (MMK)" min="100" step="100">
            <button onclick="submitWithdraw()">·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·Ä≠·ÄØ·Äô·Ää·Ä∫</button>
            <button onclick="closeModal('withdrawModal')">‚ùå ·Äï·Ä≠·Äê·Ä∫·Äô·Ää·Ä∫</button>
        </div>
    </div>

    <script>
        let userId = null;
        let phone = null;
        let balance = 0;
        let totalBet = 0;
        let currentChip = null;
        let bets = {};
        let allBets = {};
        let timeLeft = 30;
        let gameState = 'betting';
        let usedTransactionIds = [];
        let onlinePlayers = 0;
        let bonusSlots = [];
        let history = [];
        let lastGameState = null;

        const spinBtn = document.getElementById('spinBtn');
        const balanceValue = document.getElementById('balance-value');
        const betTable = document.getElementById('betTable');
        const roulette = document.getElementById('roulette');
        const betChips = document.getElementById('betChips');
        const timer = document.getElementById('timer');
        const result = document.getElementById('result');
        const gameContainer = document.getElementById('gameContainer');
        const historyDiv = document.getElementById('history');

        // Anonymous Login
        function login() {
            const inputPhone = document.getElementById('phone').value;
            const inputPin = document.getElementById('pin').value;
            if (!inputPhone || !inputPin || inputPin.length !== 6 || !inputPhone.match(/^09\d{8,9}$/)) {
                result.innerHTML = "‚ùå ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Äê·Ä∫ ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ PIN ·Äô·Äô·Äæ·Äî·Ä∫·Äï·Ä´!";
                return;
            }
            phone = inputPhone;
            userId = btoa(phone + inputPin);
            localStorage.setItem('userId', userId);
            localStorage.setItem('phone', phone);
            let userData = JSON.parse(localStorage.getItem('user_' + userId)) || {
                phone: phone,
                balance: 10000, // ·ÄÖ·Äô·Ä∫·Ä∏·Äû·Äï·Ä∫·Äñ·Ä≠·ÄØ·Ä∑ 10,000 MMK
                bets: {},
                history: [],
                usedTransactionIds: []
            };
            localStorage.setItem('user_' + userId, JSON.stringify(userData));
            updateUserInfo(userId, userData);
            loadUserData();
            document.getElementById('loginModal').style.display = 'none';
            gameContainer.style.display = 'flex';
            syncGameState();
        }

        // Logout
        function logout() {
            localStorage.removeItem('userId');
            localStorage.removeItem('phone');
            window.location.href = 'https://casino-opper.netlify.app';
        }

        // Load User Data
        function loadUserData() {
            const userData = JSON.parse(localStorage.getItem('user_' + userId));
            balance = userData.balance || 0;
            bets = userData.bets || {};
            history = userData.history || [];
            usedTransactionIds = userData.usedTransactionIds || [];
            updateBalance();
        }

        // Update UI
        function updateUI() {
            updateBalance();
            onlinePlayers = JSON.parse(localStorage.getItem('onlinePlayers') || '0');
            document.getElementById('online-players').innerHTML = `Online Players: ${onlinePlayers}`;
            allBets = JSON.parse(localStorage.getItem('allBets') || '{}');
            updateBetCounts(allBets);
            updateHistory();
            timer.innerHTML = `Time Left: ${timeLeft}s`;

            const gameData = JSON.parse(localStorage.getItem('gameData') || '{}');
            if (!gameData || !gameData.isRunning) {
                result.innerHTML = "‚è≥ Admin ·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Äî·Ä∫ ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äï·Ä´...";
                betTable.style.display = 'none';
                betChips.style.display = 'none';
                roulette.style.display = 'none';
                return;
            }

            if (gameState === 'betting' && timeLeft > 7) {
                betTable.style.display = 'grid';
                betChips.style.display = 'flex';
                roulette.style.display = 'none';
                result.innerHTML = "üé≤ Chip ·Äõ·ÄΩ·Ä±·Ä∏·Äï·Äº·ÄÆ·Ä∏ Bet ·Äê·ÄÑ·Ä∫·Äï·Ä´!";
            } else if (gameState === 'betting' && timeLeft <= 7) {
                betTable.style.display = 'none';
                betChips.style.display = 'none';
                roulette.style.display = 'none';
                result.innerHTML = "‚è≥ Betting ·Äï·Ä≠·Äê·Ä∫·Äê·Ä±·Ä¨·Ä∑·Äô·Ää·Ä∫!";
            } else if (gameState === 'spinning' && lastGameState !== 'spinning') {
                startSpin(gameData.finalAngle);
            } else if (gameState === 'result' && lastGameState !== 'result') {
                showResult(gameData.result);
                resetGame();
            }
            lastGameState = gameState;
        }

        // Sync Game State with Admin
        function syncGameState() {
            setInterval(() => {
                const gameData = JSON.parse(localStorage.getItem('gameData') || '{}');
                if (!gameData || !gameData.isRunning) {
                    gameState = 'stopped';
                    timeLeft = 30;
                    bets = {};
                    bonusSlots = [];
                    updateUI();
                    return;
                }
                gameState = gameData.state || 'betting';
                timeLeft = gameData.timeLeft || 30;
                allBets = gameData.bets || {};
                onlinePlayers = gameData.onlinePlayers || 0;
                bonusSlots = gameData.bonusSlots || [];
                updateUI();
            }, 1000); // ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ ·Ä°·Äï·Ä∫·Äí·Ä≠·Äê·Ä∫·Äú·ÄØ·Äï·Ä∫·Äô·Äö·Ä∫
        }

        function setupRoulette() {
            const numbers = Array.from({ length: 36 }, (_, i) => i + 1);
            numbers.forEach((num, i) => {
                const slot = document.createElement('div');
                slot.className = 'number-slot';
                slot.textContent = num;
                slot.style.transform = `rotate(${i * 10}deg) translateY(-135px)`;
                slot.style.background = i % 2 === 0 ? '#000' : '#f44336';
                roulette.appendChild(slot);
            });
            const pointer = document.createElement('div');
            pointer.id = 'pointer';
            pointer.className = 'pointer';
            roulette.appendChild(pointer);
        }

        function updateBalance(amount = 0) {
            if (amount !== 0) {
                balance += amount;
                const userData = JSON.parse(localStorage.getItem('user_' + userId));
                userData.balance = balance;
                localStorage.setItem('user_' + userId, JSON.stringify(userData));
                updateUserInfo(userId, userData);
            }
            balanceValue.innerHTML = balance;
            document.getElementById('balance').innerHTML = `Balance: <span id="balance-value">${balance}</span> MMK`;
        }

        function updateUserInfo(userId, userData) {
            let userInfo = JSON.parse(localStorage.getItem('userInfo') || '[]');
            const existingUserIndex = userInfo.findIndex(u => u.userId === userId);
            if (existingUserIndex !== -1) {
                userInfo[existingUserIndex] = { userId, phone: userData.phone, balance: userData.balance };
            } else {
                userInfo.push({ userId, phone: userData.phone, balance: userData.balance });
                onlinePlayers++;
                localStorage.setItem('onlinePlayers', onlinePlayers);
            }
            localStorage.setItem('userInfo', JSON.stringify(userInfo));
        }

        function showDepositModal() { document.getElementById('depositModal').style.display = 'flex'; }
        function showWithdrawModal() { document.getElementById('withdrawModal').style.display = 'flex'; }
        function closeModal(modalId) { document.getElementById(modalId).style.display = 'none'; }

        function submitDeposit() {
            const amount = parseInt(document.getElementById('deposit-amount').value);
            const transactionId = document.getElementById('transaction-id').value;
            if (!amount || amount < 100 || !transactionId || transactionId.length !== 6 || usedTransactionIds.includes(transactionId)) {
                result.innerHTML = "‚ùå ·ÄÑ·ÄΩ·Ä±·Äï·Äô·Ä¨·Äè ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Transaction ID ·Äô·Äô·Äæ·Äî·Ä∫·Äï·Ä´!";
                return;
            }
            usedTransactionIds.push(transactionId);
            const userData = JSON.parse(localStorage.getItem('user_' + userId));
            userData.usedTransactionIds = usedTransactionIds;
            localStorage.setItem('user_' + userId, JSON.stringify(userData));
            const requestId = `${userId}_${Date.now()}`;
            let requests = JSON.parse(localStorage.getItem('requests') || '{}');
            requests[requestId] = { userId, amount, transactionId, phone, type: 'deposit', status: 'pending', timestamp: Date.now() };
            localStorage.setItem('requests', JSON.stringify(requests));
            result.innerHTML = "‚è≥ Deposit ·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·Ä≠·ÄØ·Äô·Äæ·ÄØ ·Äï·Ä≠·ÄØ·Ä∑·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!";
            closeModal('depositModal');
            checkRequestStatus(requestId, 'deposit');
        }

        function submitWithdraw() {
            const method = document.getElementById('withdraw-method').value;
            const phoneWithdraw = document.getElementById('withdraw-phone').value;
            const amount = parseInt(document.getElementById('withdraw-amount').value);
            if (!amount || amount < 100 || amount > balance || !phoneWithdraw) {
                result.innerHTML = "‚ùå ·ÄÑ·ÄΩ·Ä±·Äï·Äô·Ä¨·Äè ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Äê·Ä∫ ·Äô·Äô·Äæ·Äî·Ä∫·Äï·Ä´!";
                return;
            }
            updateBalance(-amount);
            const requestId = `${userId}_${Date.now()}`;
            let requests = JSON.parse(localStorage.getItem('requests') || '{}');
            requests[requestId] = { userId, amount, method, phone: phoneWithdraw, type: 'withdraw', status: 'pending', timestamp: Date.now() };
            localStorage.setItem('requests', JSON.stringify(requests));
            result.innerHTML = "‚è≥ Withdraw ·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·Ä≠·ÄØ·Äô·Äæ·ÄØ ·Äï·Ä≠·ÄØ·Ä∑·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!";
            closeModal('withdrawModal');
            checkRequestStatus(requestId, 'withdraw');
        }

        function checkRequestStatus(requestId, type) {
            const interval = setInterval(() => {
                let requests = JSON.parse(localStorage.getItem('requests') || '{}');
                const req = requests[requestId];
                if (req && req.status !== 'pending') {
                    clearInterval(interval);
                    if (req.status === 'approved') {
                        if (type === 'deposit') updateBalance(req.amount);
                        result.innerHTML = `‚úÖ ${type === 'deposit' ? 'Deposit' : 'Withdraw'} ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ!`;
                    } else {
                        if (type === 'withdraw') updateBalance(req.amount);
                        result.innerHTML = `‚ùå ${type === 'deposit' ? 'Deposit' : 'Withdraw'} ·Äï·Äö·Ä∫·ÄÅ·Äª·ÄÅ·Ä∂·Äõ·Äï·Ä´·Äê·Äö·Ä∫!`;
                    }
                }
            }, 1000);
        }

        function setupBetTable() {
            const table = [
                ...Array.from({ length: 36 }, (_, i) => ({
                    id: `${i + 1}`,
                    text: `${i + 1}`,
                    class: i % 2 === 0 ? 'black' : 'red',
                    colSpan: 1
                })),
                { id: '1-18', text: '1-18', class: '', colSpan: 2 },
                { id: '19-36', text: '19-36', class: '', colSpan: 2 },
                { id: 'odd', text: 'Odd', class: '', colSpan: 2 },
                { id: 'even', text: 'Even', class: '', colSpan: 2 },
                { id: 'black', text: 'Black', class: 'black', colSpan: 2 },
                { id: 'red', text: 'Red', class: 'red', colSpan: 2 },
                { id: '1st12', text: '1-12', class: '', colSpan: 2 },
                { id: '2nd12', text: '13-24', class: '', colSpan: 2 },
                { id: '3rd12', text: '25-36', class: '', colSpan: 2 },
                { id: 'col1', text: '1st', class: '', colSpan: 2 },
                { id: 'col2', text: '2nd', class: '', colSpan: 2 },
                { id: 'col3', text: '3rd', class: '', colSpan: 2 }
            ];
            table.forEach(area => {
                const div = document.createElement('div');
                div.className = `bet-area ${area.class}`;
                div.id = `bet-${area.id}`;
                div.innerHTML = `
                    ${area.text}
                    <span class="user-bet" id="user-bet-${area.id}">0</span>
                    <span class="all-bet" id="all-bet-${area.id}">0</span>
                `;
                div.style.gridColumn = area.colSpan > 1 ? `span ${area.colSpan}` : 'auto';
                div.onclick = () => placeBet(area.id);
                betTable.appendChild(div);
            });
        }

        function placeBet(areaId) {
            if (gameState !== 'betting' || timeLeft <= 7 || !currentChip || balance < currentChip) return;
            balance -= currentChip;
            bets[areaId] = (bets[areaId] || 0) + currentChip;
            const userData = JSON.parse(localStorage.getItem('user_' + userId));
            userData.bets = bets;
            userData.balance = balance;
            localStorage.setItem('user_' + userId, JSON.stringify(userData));
            updateUserInfo(userId, userData);
            allBets[areaId] = (allBets[areaId] || 0) + currentChip;
            localStorage.setItem('allBets', JSON.stringify(allBets));
            updateBetCounts(allBets);
            const chipElement = document.createElement('div');
            chipElement.className = 'chip-animation';
            chipElement.textContent = currentChip >= 1000 ? `${currentChip/1000}K` : currentChip;
            const balancePos = balanceValue.getBoundingClientRect();
            const targetPos = document.getElementById(`bet-${areaId}`).getBoundingClientRect();
            chipElement.style.left = `${balancePos.left + balancePos.width / 2 - 20}px`;
            chipElement.style.top = `${balancePos.top + balancePos.height / 2 - 20}px`;
            chipElement.style.setProperty('--target-x', `${targetPos.left - balancePos.left}px`);
            chipElement.style.setProperty('--target-y', `${targetPos.top - balancePos.top}px`);
            document.body.appendChild(chipElement);
            setTimeout(() => chipElement.remove(), 1000);
        }

        function updateBetCounts(allBets) {
            for (let i = 1; i <= 36; i++) {
                const userBetEl = document.getElementById(`user-bet-${i}`);
                const allBetEl = document.getElementById(`all-bet-${i}`);
                if (userBetEl) userBetEl.innerHTML = bets[i] ? (bets[i] >= 1000 ? `${bets[i]/1000}K` : bets[i]) : '0';
                if (allBetEl) allBetEl.innerHTML = allBets[i] ? (allBets[i] >= 1000 ? `${allBets[i]/1000}K` : allBets[i]) : '0';
                const bonusEl = document.getElementById(`bet-${i}`).querySelector('.bonus-x');
                if (bonusSlots.some(slot => slot.number === i)) {
                    if (!bonusEl) {
                        const bonusX = document.createElement('span');
                        bonusX.className = 'bonus-x';
                        bonusX.innerHTML = `x${bonusSlots.find(slot => slot.number === i).bonus}`;
                        document.getElementById(`bet-${i}`).appendChild(bonusX);
                    }
                } else if (bonusEl) bonusEl.remove();
            }
            ['1-18', '19-36', 'odd', 'even', 'black', 'red', '1st12', '2nd12', '3rd12', 'col1', 'col2', 'col3'].forEach(area => {
                const userBetEl = document.getElementById(`user-bet-${area}`);
                const allBetEl = document.getElementById(`all-bet-${area}`);
                if (userBetEl) userBetEl.innerHTML = bets[area] ? (bets[area] >= 1000 ? `${bets[area]/1000}K` : bets[area]) : '0';
                if (allBetEl) allBetEl.innerHTML = allBets[area] ? (allBets[area] >= 1000 ? `${allBets[area]/1000}K` : allBets[area]) : '0';
            });
        }

        function startSpin(finalAngle) {
            const pointer = document.getElementById('pointer');
            roulette.style.display = 'block';
            betTable.style.display = 'none';
            betChips.style.display = 'none';
            result.innerHTML = "·Äò·Ä±·Ä¨·Äú·ÄØ·Ä∂·Ä∏·Äú·Äæ·Ää·Ä∑·Ä∫·Äî·Ä±·Äï·Ä´·Äê·Äö·Ä∫... ‚è≥";
            pointer.style.setProperty('--final-angle', `${finalAngle}deg`);
            pointer.classList.add('spinning');
            setTimeout(() => {
                pointer.classList.remove('spinning');
            }, 8000); // Spin ·ÄÄ·Äº·Ä¨·ÄÅ·Äª·Ä≠·Äî·Ä∫ 8 ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫
        }

        function showResult(resultData) {
            const number = resultData.number;
            let winnings = 0;
            let message = `üé≤ ·Äò·Ä±·Ä¨·Äú·ÄØ·Ä∂·Ä∏·Äõ·Äï·Ä∫·Äû·ÄΩ·Ä¨·Ä∏·Äê·Ä≤·Ä∑ ·ÄÇ·Äè·Äî·Ä∫·Ä∏: ${number}<br>`;
            const bonusMultiplier = bonusSlots.find(slot => slot.number === parseInt(number))?.bonus || 0;
            for (let area in bets) {
                let multiplier = 0;
                if (area === `${number}`) multiplier = 36 + bonusMultiplier;
                else if (area === 'red' && resultData.isRed) multiplier = 2;
                else if (area === 'black' && resultData.isBlack) multiplier = 2;
                else if (area === 'odd' && resultData.isOdd) multiplier = 2;
                else if (area === 'even' && resultData.isEven) multiplier = 2;
                else if (area === '1-18' && resultData.isLow) multiplier = 2;
                else if (area === '19-36' && resultData.isHigh) multiplier = 2;
                else if (area === resultData.dozen) multiplier = 3;
                else if (area === resultData.column) multiplier = 3;
                if (multiplier > 0) {
                    winnings += bets[area] * multiplier;
                }
            }
            if (winnings > 0) {
                message += `üéâ ·Ä°·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äê·Äö·Ä∫! ${winnings} MMK`;
                updateBalance(winnings);
            } else {
                message += "üò¢ ·Ä°·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·Åã ·Äë·Äï·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·Ä∏·ÄÖ·Ä¨·Ä∏·Äï·Ä´!";
            }
            result.innerHTML = message;
            updateHistory(resultData);
            resetGame();
        }

        function resetGame() {
            bets = {};
            const userData = JSON.parse(localStorage.getItem('user_' + userId));
            userData.bets = bets;
            localStorage.setItem('user_' + userId, JSON.stringify(userData));
            updateUserInfo(userId, userData);
            allBets = {};
            localStorage.setItem('allBets', JSON.stringify(allBets));
            updateBetCounts(allBets);
            clearBetTable();
            clearGreenBets();
        }

        function clearBetTable() {
            for (let i = 1; i <= 36; i++) {
                const betArea = document.getElementById(`bet-${i}`);
                const chip = betArea && betArea.querySelector('.bet-chip');
                if (chip) chip.remove();
                const bonusEl = betArea && betArea.querySelector('.bonus-x');
                if (bonusEl) bonusEl.remove();
            }
            ['1-18', '19-36', 'odd', 'even', 'black', 'red', '1st12', '2nd12', '3rd12', 'col1', 'col2', 'col3'].forEach(area => {
                const betArea = document.getElementById(`bet-${area}`);
                const chip = betArea && betArea.querySelector('.bet-chip');
                if (chip) chip.remove();
            });
        }

        function clearGreenBets() {
            document.querySelectorAll('.bet-area.green').forEach(area => {
                area.classList.remove('green');
            });
        }

        function updateHistory(resultData) {
            history.push({ number: resultData.number, isBlack: resultData.isBlack });
            if (history.length > 10) history.shift();
            const userData = JSON.parse(localStorage.getItem('user_' + userId));
            userData.history = history;
            localStorage.setItem('user_' + userId, JSON.stringify(userData));
            let historyHTML = '';
            history.forEach(item => {
                const className = item.isBlack ? 'black' : 'red';
                historyHTML += `<span class="history-item ${className}">${item.number}</span> `;
            });
            historyDiv.innerHTML = historyHTML || 'No history yet';
        }

        document.querySelectorAll('.chip').forEach(chip => {
            chip.onclick = () => {
                document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                currentChip = parseInt(chip.dataset.value);
            };
        });

        function toggleGuide() {
            document.getElementById('guide').classList.toggle('active');
        }

        // Initialize
        if (localStorage.getItem('userId') && localStorage.getItem('phone')) {
            userId = localStorage.getItem('userId');
            phone = localStorage.getItem('phone');
            document.getElementById('loginModal').style.display = 'none';
            gameContainer.style.display = 'flex';
            loadUserData();
            syncGameState();
        } else {
            window.location.href = 'https://casino-opper.netlify.app';
        }
        setupBetTable();
        setupRoulette();
    </script>
</body>
</html>
